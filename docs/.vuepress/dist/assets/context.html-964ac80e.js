import{_ as l,W as r,X as u,a4 as d,Y as n,$ as s,Z as a,a2 as p,a5 as e,D as t}from"./framework-4c9bc095.js";const k={},v=n("p",null,[s("While running a "),n("code",null,"listr2"),s(" task list, a self-contained variable is shared across the running tasks called the "),n("code",null,"ctx"),s(". This has the same basic idea as shared contexts in other programming languages.")],-1),b=n("h2",{id:"context-variable",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#context-variable","aria-hidden":"true"},"#"),s(" Context Variable")],-1),h=n("p",null,"A context is an object that is shared across the task list. Even though external variables can be used to do the same operation, context gives a self-contained way to process internal tasks.",-1),m=n("code",null,"any",-1),g=e(`<p>Context type can be injected as a type parameter to Listr class to limit what is being used as the context throughout the task and ensure type safety.</p><ul><li>A successful task will return the context for further operation.</li><li>Context can be injected from outside while creating the task list or running the task list.</li><li>If an error is encountered, the context at the time will be recorded as a frozen object to give the ability to further debug the issue.</li></ul><p>You can also manually inject a context variable default in multiple ways.</p><div class="hint-container info"><p class="hint-container-title">Hint</p><p>If all tasks are in the same task list, the context will be automatically injected into all the subtasks.</p></div><h2 id="injecting-context" tabindex="-1"><a class="header-anchor" href="#injecting-context" aria-hidden="true">#</a> Injecting Context</h2><h3 id="injecting-context-as-an-option" tabindex="-1"><a class="header-anchor" href="#injecting-context-as-an-option" aria-hidden="true">#</a> Injecting Context as an Option</h3><p>Context can be injected as an option to the <a href="/api/classes/Listr.html" target="_blank">Listr</a>.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Ctx</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">const</span> ctx<span class="token operator">:</span> Ctx <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Listr<span class="token operator">&lt;</span>Ctx<span class="token operator">&gt;</span></span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>
    <span class="token comment">/* tasks */</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> ctx <span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token keyword">await</span> tasks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><div class="highlight-line"> </div><br><br><br><br><br><br></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,8),x={id:"multiple-contexts-612",tabindex:"-1"},y=n("a",{class:"header-anchor",href:"#multiple-contexts-612","aria-hidden":"true"},"#",-1),f=n("a",{href:"https://github.com/cenk1cenk2/listr2/issues/612",target:"_blank"},"#612",-1),w=n("p",null,"This can also be used to inject a different context into subtasks. Imagine that you want to have some set of variables that you want to use only the subtask context, then you can pass it through the option. This variable will be garbage-collected whenever the subtasks finish. So if you want to return some values before it gets lost forever, you can just assign them to the parent context since it is accessible.",-1),_={class:"hint-container details"},C=e(`<div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Listr <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;listr2&#39;</span>

<span class="token keyword">interface</span> <span class="token class-name">Ctx</span> <span class="token punctuation">{</span>
  subtask<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">SubtaskCtx</span> <span class="token punctuation">{</span>
  operation<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> subtaskContext<span class="token operator">:</span> SubtaskCtx <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Listr<span class="token operator">&lt;</span>Ctx<span class="token operator">&gt;</span></span><span class="token punctuation">(</span>
  <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      task<span class="token operator">:</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> task<span class="token punctuation">)</span><span class="token operator">:</span> Listr <span class="token operator">=&gt;</span>
        task<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">newListr</span><span class="token generic class-name"><span class="token operator">&lt;</span>SubtaskCtx<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
          <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
              title<span class="token operator">:</span> <span class="token string">&#39;This is a subtask.&#39;</span><span class="token punctuation">,</span>
              task<span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>subCtx<span class="token punctuation">,</span> task<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                subCtx<span class="token punctuation">.</span>operation <span class="token operator">=</span> <span class="token boolean">true</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>

            <span class="token punctuation">{</span>
              title<span class="token operator">:</span> <span class="token string">&#39;This is a subtask.&#39;</span><span class="token punctuation">,</span>
              <span class="token function-variable function">skip</span><span class="token operator">:</span> <span class="token punctuation">(</span>subCtx<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">!</span>subCtx<span class="token punctuation">.</span>operation<span class="token punctuation">,</span>
              task<span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>subCtx<span class="token punctuation">,</span> task<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                ctx<span class="token punctuation">.</span>subtask <span class="token operator">=</span> <span class="token boolean">true</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">]</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> ctx<span class="token operator">:</span> subtaskContext <span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">)</span>

<span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">await</span> tasks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),j=e(`<h3 id="injecting-context-at-runtime" tabindex="-1"><a class="header-anchor" href="#injecting-context-at-runtime" aria-hidden="true">#</a> Injecting Context at Runtime</h3><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Ctx</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">const</span> ctx<span class="token operator">:</span> Ctx <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Listr<span class="token operator">&lt;</span>Ctx<span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token comment">/* tasks */</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">await</span> tasks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">{</span> ctx <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlight-line"> </div></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="retrieving-context" tabindex="-1"><a class="header-anchor" href="#retrieving-context" aria-hidden="true">#</a> Retrieving Context</h2><h3 id="as-the-returnvalue-of-the-task" tabindex="-1"><a class="header-anchor" href="#as-the-returnvalue-of-the-task" aria-hidden="true">#</a> As the ReturnValue of the Task</h3><p>A successful task will always return the context at the end of the task.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Listr</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    task<span class="token operator">:</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span>test <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> ctx <span class="token operator">=</span> <span class="token keyword">await</span> tasks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ctx<span class="token punctuation">.</span>test<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlight-line"> </div><br><div class="highlight-line"> </div></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="as-property-of-task-list" tabindex="-1"><a class="header-anchor" href="#as-property-of-task-list" aria-hidden="true">#</a> As Property of Task List</h3><p>The root <a href="/api/classes/Listr.html" target="_blank">Listr</a> class itself holds the context value as a public property.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> tasks <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Listr</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    task<span class="token operator">:</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span>test <span class="token operator">=</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">await</span> tasks<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>tasks<span class="token punctuation">.</span>ctx<span class="token punctuation">.</span>test<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre><div class="highlight-lines"><div class="highlight-line"> </div><br><br><br><br><br><br><br><br><br><div class="highlight-line"> </div></div><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,9);function L(T,I){const i=t("RouterLink"),o=t("FontIcon"),c=t("Badge");return r(),u("div",null,[v,d(" more "),b,h,n("p",null,[s("Context can be anything that satisfies the type "),a(i,{to:"/api/types/ListrContext.html"},{default:p(()=>[s("ListrContext")]),_:1}),s(" which mostly types "),m,s(", but it is advised to be an object, due to the intention of using it as a mutable structure that goes through the task.")]),g,n("h4",x,[y,s(" Multiple Contexts "),a(c,{type:"warning"},{default:p(()=>[a(o,{icon:"mdi:github"}),f]),_:1})]),w,n("details",_,[n("summary",null,[a(o,{icon:"material-symbols:code-blocks-outline"}),s(" Code Example")]),C]),j])}const A=l(k,[["render",L],["__file","context.html.vue"]]);export{A as default};
